---
layout: post
title: 'php? c?'
date: 2019-07-12
author: JSB
color: rgb(100,50,100)
cover: '/screenshot/wargame/wargame.png'
tags: wargame.kr webhacking
---

# php? c?
<img src="/screenshot/wargame/wargame-3-1.png">

	32비트 애플리캐이션의 interger 타입을 아냐고 힌트를 주었다.

## get souce를 눌러서 들어가면 나오는 코드
<div class="colorscripter-code" style="color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#fafafa;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #e5e5e5"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#666;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div><div style="line-height:130%">20</div><div style="line-height:130%">21</div><div style="line-height:130%">22</div><div style="line-height:130%">23</div><div style="line-height:130%">24</div><div style="line-height:130%">25</div><div style="line-height:130%">26</div><div style="line-height:130%">27</div><div style="line-height:130%">28</div><div style="line-height:130%">29</div><div style="line-height:130%">30</div><div style="line-height:130%">31</div><div style="line-height:130%">32</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">&lt;?php</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;<span style="color:#a71d5d">if</span>&nbsp;(<span style="color:#066de2">isset</span>(<span style="color:#066de2">$_GET</span>[<span style="color:#63a35c">'view-source'</span>]))&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;show_source(__FILE__);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">exit</span>();</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;<span style="color:#a71d5d">require</span>(<span style="color:#63a35c">"/lib.php"</span>);&nbsp;<span style="color:#999999">//&nbsp;include&nbsp;for&nbsp;auth_code&nbsp;function.</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;<span style="color:#a71d5d">if</span>(<span style="color:#066de2">isset</span>(<span style="color:#066de2">$_POST</span>[<span style="color:#63a35c">'d1'</span>])&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">&amp;</span><span style="color:#0086b3"></span><span style="color:#a71d5d">&amp;</span>&nbsp;<span style="color:#066de2">isset</span>(<span style="color:#066de2">$_POST</span>[<span style="color:#63a35c">'d2'</span>])){</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#066de2">$input1</span>=(<span style="color:#066de2">int</span>)<span style="color:#066de2">$_POST</span>[<span style="color:#63a35c">'d1'</span>];</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#066de2">$input2</span>=(<span style="color:#066de2">int</span>)<span style="color:#066de2">$_POST</span>[<span style="color:#63a35c">'d2'</span>];</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#a71d5d">if</span>(<span style="color:#0086b3"></span><span style="color:#a71d5d">!</span>is_file(<span style="color:#63a35c">"/tmp/p7"</span>)){exec(<span style="color:#63a35c">"gcc&nbsp;-o&nbsp;/tmp/p7&nbsp;./p7.c"</span>);}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#066de2">$result</span>=exec(<span style="color:#63a35c">"/tmp/p7&nbsp;"</span>.<span style="color:#066de2">$input1</span>);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#a71d5d">if</span>(<span style="color:#066de2">$result</span>!<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0099cc">1</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">&amp;</span><span style="color:#0086b3"></span><span style="color:#a71d5d">&amp;</span>&nbsp;<span style="color:#066de2">$result</span>=<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#066de2">$input2</span>){<span style="color:#066de2">echo</span>&nbsp;auth_code(<span style="color:#63a35c">"php?&nbsp;c?"</span>);}<span style="color:#a71d5d">else</span>{<span style="color:#066de2">echo</span>&nbsp;<span style="color:#63a35c">"try&nbsp;again!"</span>;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;}<span style="color:#a71d5d">else</span>{<span style="color:#066de2">echo</span>&nbsp;<span style="color:#63a35c">":p"</span>;}</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">?&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#010101">&lt;</span><span style="color:#066de2">style</span><span style="color:#010101">&gt;</span><span style="color:#ff3399"></span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">&nbsp;table&nbsp;</span>{<span style="color:#0099cc">background-color</span><span style="color:#ff3399">:</span><span style="color:#0066cc">#000</span><span style="color:#ff3399">;</span><span style="color:#0099cc">&nbsp;color</span><span style="color:#ff3399">:</span><span style="color:#0066cc">#fff</span><span style="color:#ff3399">;</span><span style="color:#0066cc"></span>}<span style="color:#ff3399"></span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">&nbsp;td&nbsp;</span>{<span style="color:#0099cc">background-color</span><span style="color:#ff3399">:</span><span style="color:#0066cc">#444</span><span style="color:#ff3399">;</span><span style="color:#0066cc"></span>}</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#010101">&lt;</span><span style="color:#010101">/</span><span style="color:#066de2">style</span><span style="color:#010101">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#010101">&lt;</span><span style="color:#066de2">hr</span>&nbsp;<span style="color:#0a9989">/</span><span style="color:#010101">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;<span style="color:#010101">&lt;</span><span style="color:#066de2">center</span><span style="color:#010101">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#010101">&lt;</span><span style="color:#066de2">form</span>&nbsp;<span style="color:#0a9989">method</span>=<span style="color:#df5000">'post'</span><span style="color:#0a9989"></span><span style="color:#010101">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#010101">&lt;</span><span style="color:#066de2">table</span><span style="color:#010101">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#010101">&lt;</span><span style="color:#066de2">tr</span><span style="color:#010101">&gt;</span><span style="color:#010101">&lt;</span><span style="color:#066de2">td</span><span style="color:#010101">&gt;</span>D1:<span style="color:#010101">&lt;</span><span style="color:#010101">/</span><span style="color:#066de2">td</span><span style="color:#010101">&gt;</span><span style="color:#010101">&lt;</span><span style="color:#066de2">td</span><span style="color:#010101">&gt;</span><span style="color:#010101">&lt;</span><span style="color:#066de2">input</span>&nbsp;<span style="color:#0a9989">type</span>=<span style="color:#df5000">'text'</span><span style="color:#0a9989"></span>&nbsp;<span style="color:#0a9989">id</span>=<span style="color:#df5000">"firstf"</span><span style="color:#0a9989"></span>&nbsp;<span style="color:#0a9989">style</span>=<span style="color:#df5000">"width:75px;"</span><span style="color:#0a9989"></span>&nbsp;<span style="color:#0a9989">maxlength</span>=<span style="color:#df5000">"9"</span><span style="color:#0a9989"></span>&nbsp;<span style="color:#0a9989">name</span>=<span style="color:#df5000">'d1'</span><span style="color:#0a9989"></span><span style="color:#010101">&gt;</span><span style="color:#010101">&lt;</span><span style="color:#010101">/</span><span style="color:#066de2">td</span><span style="color:#010101">&gt;</span><span style="color:#010101">&lt;</span><span style="color:#010101">/</span><span style="color:#066de2">tr</span><span style="color:#010101">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#010101">&lt;</span><span style="color:#066de2">tr</span><span style="color:#010101">&gt;</span><span style="color:#010101">&lt;</span><span style="color:#066de2">td</span><span style="color:#010101">&gt;</span>D2:<span style="color:#010101">&lt;</span><span style="color:#010101">/</span><span style="color:#066de2">td</span><span style="color:#010101">&gt;</span><span style="color:#010101">&lt;</span><span style="color:#066de2">td</span><span style="color:#010101">&gt;</span><span style="color:#010101">&lt;</span><span style="color:#066de2">input</span>&nbsp;<span style="color:#0a9989">type</span>=<span style="color:#df5000">'text'</span><span style="color:#0a9989"></span>&nbsp;<span style="color:#0a9989">style</span>=<span style="color:#df5000">"width:75px;"</span><span style="color:#0a9989"></span>&nbsp;<span style="color:#0a9989">name</span>=<span style="color:#df5000">'d2'</span><span style="color:#0a9989"></span><span style="color:#010101">&gt;</span><span style="color:#010101">&lt;</span><span style="color:#010101">/</span><span style="color:#066de2">td</span><span style="color:#010101">&gt;</span><span style="color:#010101">&lt;</span><span style="color:#010101">/</span><span style="color:#066de2">tr</span><span style="color:#010101">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#010101">&lt;</span><span style="color:#066de2">tr</span><span style="color:#010101">&gt;</span><span style="color:#010101">&lt;</span><span style="color:#066de2">td</span>&nbsp;<span style="color:#0a9989">colspan</span>=<span style="color:#df5000">"2"</span><span style="color:#0a9989"></span>&nbsp;<span style="color:#0a9989">style</span>=<span style="color:#df5000">"text-align:center;"</span><span style="color:#0a9989"></span><span style="color:#010101">&gt;</span><span style="color:#010101">&lt;</span><span style="color:#066de2">input</span>&nbsp;<span style="color:#0a9989">type</span>=<span style="color:#df5000">'submit'</span><span style="color:#0a9989"></span>&nbsp;<span style="color:#0a9989">value</span>=<span style="color:#df5000">'try'</span><span style="color:#0a9989"></span><span style="color:#010101">&gt;</span><span style="color:#010101">&lt;</span><span style="color:#010101">/</span><span style="color:#066de2">td</span><span style="color:#010101">&gt;</span><span style="color:#010101">&lt;</span><span style="color:#010101">/</span><span style="color:#066de2">tr</span><span style="color:#010101">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#010101">&lt;</span><span style="color:#010101">/</span><span style="color:#066de2">table</span><span style="color:#010101">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#010101">&lt;</span><span style="color:#010101">/</span><span style="color:#066de2">form</span><span style="color:#010101">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;<span style="color:#010101">&lt;</span><span style="color:#066de2">div</span><span style="color:#010101">&gt;</span><span style="color:#010101">&lt;</span><span style="color:#066de2">a</span>&nbsp;<span style="color:#0a9989">href</span>=<span style="color:#df5000">'?view-source'</span><span style="color:#0a9989"></span><span style="color:#010101">&gt;</span>get&nbsp;source<span style="color:#010101">&lt;</span><span style="color:#010101">/</span><span style="color:#066de2">a</span><span style="color:#010101">&gt;</span><span style="color:#010101">&lt;</span><span style="color:#010101">/</span><span style="color:#066de2">div</span><span style="color:#010101">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;<span style="color:#010101">&lt;</span><span style="color:#010101">/</span><span style="color:#066de2">center</span><span style="color:#010101">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;<span style="color:#010101">&lt;</span><span style="color:#066de2">script</span><span style="color:#010101">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#066de2">document</span>.<span style="color:#066de2">getElementById</span>(<span style="color:#63a35c">"firstf"</span>).focus();</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;<span style="color:#010101">&lt;</span><span style="color:#010101">/</span><span style="color:#066de2">script</span><span style="color:#010101">&gt;</span></div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#e5e5e5text-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#e5e5e5;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>

## 해석

	p7.c 라는 c 파일을 컴파일하여 실행할때 main의인자값을 첫번째입력
    그렇게해서 나오는 값을 두번째입력과 같으면 flag를 뱉어내는것 같다.

<img src="/screenshot/wargame/wargame-3-2.png">

	main의 인자값을 int형으로 바꾼후 0보디 작으면 nono()
    i에5를 더한값이 4보다크면 nono()5보디작으면 i를 출력해야한다.
    int라는 자료형은 -2,147,483,648 ~ 2,147,438,647 까지이다.
    2147483643 에 5를 더하게 되면 -2147483648 라는 값이 나온다
    -2147483648는 4보다 크지않고 5보다 작다.

## 답
	따라서 첫번째 입력은 : 2147483643
    두번째 입력은       : -2147483648
    이렇게하면 플래그가 나온다.
    
    하지만 위값은 9가넘으므로 개발자도구로 maxlength를 지우면 된다.
    
<img src="/screenshot/wargame/wargame-3-3.png">
